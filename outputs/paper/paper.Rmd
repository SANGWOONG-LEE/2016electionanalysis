---
title: "Numerous variables relating to 2016 election in 2021 US GSS^[Code and data are available at: https://github.com/SANGWOONG-LEE/2016electionanalysis]"
subtitle: "Possible factors effecting 2016 election"
author: 
  - SangWoong Lee
  - Young Suk
date: "`r format(Sys.time(), '%d %B %Y')`"
abstract: "First sentence (what was done). Second sentence(what was found). Third sentence (why this matters). Fourth sentence."
output:
  bookdown::pdf_document2:
    fig_caption: yes
toc: FALSE
bibliography: references.bib
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir = rprojroot::find_rstudio_root_file())
library(tidyverse)
library(dplyr)
library(knitr)
```

# Introduction
1) broader context to motivate
2) some detail about hat the papaer is about
3) a clear gap that needs to be filled
4) what was done
5) what was found
6) why it is important
7) The structure of the paper
(3~4 paragraphs)
Donald Trump won the 2016 United States presidential election. We are not US citizens. 
However, considering 



# Data
```{r, include=FALSE, echo=FALSE}
reduced_data <- read_csv("outputs/data/prepared_gss.csv")
reduced_data$pres16 <- factor(reduced_data$pres16, levels = c("Clinton","Trump","Other","Did not vote"))


reduced_data$Family_income <- factor(reduced_data$Family_income, 
                                     levels = c("Under $10,000","$10,000 ~ $19,999","$20,000 ~ $39,999","$40,000 ~ $59,999", 
                                                "$60,000 ~ $89,999","$90,000 ~ $129,999","$130,000 ~ $169,999","$170,000 or over"))

reduced_data$Immigration <- factor(reduced_data$Immigration, levels = c("Strongly disagree","Disagree", "Neither","Agree","Strongly agree"))
```

Original dataset is collected through US GSS, which is aimed for the goal that enabling the cleanest comparison to show changes in public opinion in the United States. Usually, it is conducted in person, however because of pandemic, this time it was conducted via online. Among numerous interesting findings from the dataset, we choose to analyze the 2016 United States presidential election. This slightly deviates the US GSS goal, but we thought it clearly represents current situation of US. However, choosing specific variables related to the election was not easy since deciding who to vote is followed by countless factors. After looking over the variables, we chose age,race,gender,degree,born US, Family income, national spending on education, race, arms, welfare, the poor, the other countries, social security and immigration as potential variables. 
We mainly divided the variables into two parts: personal information (Age, race, gender, degree, born US and family income) and thoughts on national policies (national spending on education, race, arms, welfare, the poor, the other countries, social security and immigration).
As I mentioned above, deciding who to vote is followed by very complex system of thoughts. Thus, as we cut down the variables, they do not guarantee 100% of the vote. Also, we thought that excluding non-response completely would affect our understandings of data, so even though it caused difficulties in interpretation, we decided to include it except "pres16", which is our main variable whether respondents voted for Clinton and Trump. This is because non-response does not have meanings regarding our interests.There exists similar survey similar to ours, CNN exit polls, however it is not easy to obtain the datasets they used. Also, US GSS is more realistic than exit polls since people would think more rational in US GSS than exit polls. 
Now, let's get into the variables in details. One thing that we focused was whether respondents were equivalently recruited. To do this, we first have to look at respondents' personal information. If you take a look from Figure \ref{fig:fig1} to Figure \ref{fig:fig4}. There exists some interesting things. 
1) number of survey participants of age in the range of 20~40 is unexpectedly low compared to other ages. \ref{fig:fig1}
2) There are more white race than others. However, considering US race demographics, it is very reasonable. \ref{fig:fig2}
For more details on US race demographics, https://www.census.gov/quickfacts/fact/table/US/PST045221.
3) For gender, there is slightly more female than male, and we will see later whether this has impacts on vote or not. \ref{fig:fig3}
4) Clinton's vote is higher than trump's vote in this survey, which contradicts the election result of 2016, reader should keep in mind that this survey is more biased towards Clinton.
\ref{fig:fig4}
From Figure \ref{fig:fig5} to Figure \ref{fig:fig14}, they represent respondents' thoughts on national policies as well as relation between variables.  
Mostly they were collected from questions that whether you think that national spending on corresponding variables is about right, too much, or too little.

```{r fig1, include=FALSE, fig.cap = "Distribution of survey respondents' age group"}

reduced_data %>%
  drop_na(age_group) %>%
  ggplot(aes(x = age_group, fill = age_group)) +
  geom_bar() +
  coord_flip() +
  labs(x = element_blank(),
       y = element_blank(),
       title = "Survey Respondents' Age",
        )+
  theme(legend.position = "none")
```
```{r fig2, echo=FALSE, fig.cap = "Distribution of survey respondents' race"}

reduced_data %>%
  ggplot(aes(x = race, fill = race)) +
  geom_bar() +
  labs(x = element_blank(),
       y = element_blank(),
       title = "Survey Respondents' Race",
       ) +
  theme(legend.position = "none")
```
```{r fig3, echo = FALSE, fig.cap= "Distribution of survey respondents' gender"}
reduced_data %>%
  ggplot(aes(x = gender, fill = gender)) +
  geom_bar() +
  #scale_fill_manual("gender", values = c("Clinton" = "#01378C", "Trump" = "#ff3d3d", "Other" = "#2cd18c", "Did not vote" = "#dede1b")) +
  labs(x = element_blank(),
       y = element_blank(),
       title = "Survey Respondents' Gender",
       ) +
  theme(legend.position = "none")
```
```{r fig4, echo=FALSE, fig.cap = "Distribution of survey respondents' vote choice"}
reduced_data %>%
  ggplot(aes(x = pres16, fill = factor(pres16, levels = c("Clinton", "Trump", "Other", "Did not vote")))) +
  geom_bar() +
  scale_fill_manual("Candidate", values = c("Clinton" = "#01378C", "Trump" = "#ff3d3d", "Other" = "#2cd18c", "Did not vote" = "#dede1b")) +
  labs(x = element_blank(),
       y = element_blank(),
       title = "Surveyee's Vote Choice of 2016 Presidential Election",
       ) +
  theme(legend.position = "none")
```
```{r fig5, echo=FALSE, fig.cap = "Opinion on national spending on improving conditions of black population"}
reduced_data %>%
  drop_na(nation_race) %>%
  drop_na(race) %>%
  ggplot(aes(x = race, fill = nation_race)) +
  geom_bar() +
  coord_flip() +
  labs(x = element_blank(),
       y = element_blank(),
       title = "Is the US Spending Enough to Improve Conditions of Black Population?",
       ) +
  facet_wrap(~ pres16) + 
  theme(legend.title = element_blank())
```
```{r fig6, echo=FALSE,fig.cap = "Distribution of survey respondents' vote choice by birth place"}
reduced_data %>%
  ggplot(aes(x = born_US, fill = factor(pres16, levels = c("Clinton", "Trump", "Other", "Did not vote")))) +
  geom_bar() +
  scale_fill_manual("Candidate", values = c("Clinton" = "#01378C", "Trump" = "#ff3d3d", "Other" = "#2cd18c", "Did not vote" = "#dede1b")) +
  labs(x = element_blank(),
       y = element_blank(),
       title = "Surveyee's Vote Choice of 2016 Presidential Election by Brith Place",
       fil = "Candidate")
```  
```{r fig7, echo=FALSE, fig.cap = "Distribution of survey respondents' vote by gender"}
reduced_data %>%
  ggplot(aes(x = pres16, fill = gender)) +
  geom_bar() +
  coord_flip() +
  labs(x = element_blank(),
       y = element_blank(),
       title = "Surveyee's Vote Choice of 2016 Presidential Election by Gender"
       )
```
```{r fig8, echo=FALSE, fig.cap = "Opinion on national spending on welfare"}
reduced_data %>%
  drop_na(nation_welfare) %>%
  drop_na(race) %>%
  ggplot(aes(x = race, fill = nation_welfare)) +
  geom_bar() +
  coord_flip() +
  labs(x = element_blank(),
       y = element_blank(),
       title = "Is the Government Spending Enough on Welfare?",
       ) +
  facet_wrap(~ pres16) + 
  theme(legend.title = element_blank())
```
```{r fig9, echo=FALSE, fig.cap = "Distribution of votes by degree and family income"}
reduced_data %>%
  drop_na(degree) %>%
  ggplot(aes(x = degree, fill = factor(Family_income, 
                                       levels = c("$170,000 or over","$130,000 ~ $169,999","$90,000 ~ $129,999","$60,000 ~ $89,999",
                                                  "$40,000 ~ $59,999","$20,000 ~ $39,999","$10,000 ~ $19,999","Under $10,000")))) +
  geom_bar(position = "dodge") +
  labs(fill = "Family Income") +
  coord_flip() +
  facet_wrap(~pres16) +
  labs(x = element_blank(),
       y = element_blank(),
       title = "Education, Income and its Effect to the Vote"
       )
```
```{r fig10, echo=FALSE, fig.cap = "Opinion on wheter the US should limit immigration to protect their culture"}
reduced_data %>%
  ggplot(aes(x = Immigration, fill = factor(pres16, levels = c("Clinton", "Trump", "Other", "Did not vote")))) +
  geom_bar() +
  scale_fill_manual("Candidate", values = c("Clinton" = "#01378C", "Trump" = "#ff3d3d", "Other" = "#2cd18c", "Did not vote" = "#dede1b")) +
  labs(fil = "Candidate") +
  coord_flip() +
  labs(x = element_blank(),
       y = element_blank(),
       title = "Should the Government Limit Immigration?"
       ) +
  facet_wrap(~pres16)
```
```{r fig11, echo=FALSE, fig.cap = "Surveyee's opinion on government's budget on education improvement"}
reduced_data %>%
  ggplot(aes(x = nation_education, fill = factor(pres16, levels = c("Clinton", "Trump", "Other", "Did not vote")))) +
  geom_bar(position = "dodge") +
  scale_fill_manual("Candidate", values = c("Clinton" = "#01378C", "Trump" = "#ff3d3d", "Other" = "#2cd18c", "Did not vote" = "#dede1b")) +
  labs(fil = "Candidate") +
  labs(x = element_blank(),
       y = element_blank(),
       title = "Is the Government Spending Enough on Improving Education?"
       )
```
```{r fig12, echo=FALSE, fig.cap = "Surveyee's opinion on government's budget on arms"}
reduced_data %>%
  ggplot(aes(x = nation_arms, fill = factor(pres16, levels = c("Clinton", "Trump", "Other", "Did not vote")))) +
  geom_bar(position = "dodge") +
  scale_fill_manual("Candidate", values = c("Clinton" = "#01378C", "Trump" = "#ff3d3d", "Other" = "#2cd18c", "Did not vote" = "#dede1b")) +
  labs(fil = "Candidate") +
  labs(x = element_blank(),
       y = element_blank(),
       title = "Is the Government Spending Enough on Arms and National Defense?"
       )
```
```{r fig13, echo=FALSE, fig.cap= "Surveyee's opinion on government's budget on assisting the poor"}
reduced_data %>%
  ggplot(aes(x = Assistance_to_the_poor, fill = factor(pres16, levels = c("Clinton", "Trump", "Other", "Did not vote")))) +
  geom_bar(position = "dodge") +
  scale_fill_manual("Candidate", values = c("Clinton" = "#01378C", "Trump" = "#ff3d3d", "Other" = "#2cd18c", "Did not vote" = "#dede1b")) +
  labs(fil = "Candidate") +
  labs(x = element_blank(),
       y = element_blank(),
       title = "Is the Government Spending Enough to Assis the Poor?"
       )
```
```{r fig14, echo=FALSE, fig.cap = "Surveyee's opinion on government's budget on assisting other countries"}
reduced_data %>%
  ggplot(aes(x = Assistance_to_other_countries, fill = factor(pres16, levels = c("Clinton", "Trump", "Other", "Did not vote")))) +
  geom_bar(position = "dodge") +
  scale_fill_manual("Candidate", values = c("Clinton" = "#01378C", "Trump" = "#ff3d3d", "Other" = "#2cd18c", "Did not vote" = "#dede1b")) +
  labs(fil = "Candidate") +
  labs(x = element_blank(),
       y = element_blank(),
       title = "Is the Government Spending Enough to Assis Other Countries?"
       )
```
```{r, echo=FALSE}

# reduced_data %>%
#   ggplot(aes(x = degree, fill = factor(pres16, levels = c("Clinton", "Trump", "Other", "Did not vote")))) +
#   geom_bar() +
#   scale_fill_manual("Candidate", values = c("Clinton" = "#01378C", "Trump" = "#ff3d3d", "Other" = "#2cd18c", "Did not vote" = "#dede1b")) +
#   labs(fil = "Candidate")

# reduced_data %>%
#   ggplot(aes(x = Family_income, fill = factor(pres16, levels = c("Clinton", "Trump", "Other", "Did not vote")))) +
#   geom_bar() +
#   scale_fill_manual("Candidate", values = c("Clinton" = "#01378C", "Trump" = "#ff3d3d", "Other" = "#2cd18c", "Did not vote" = "#dede1b")) +
#   labs(fil = "Candidate") +
#   coord_flip()

# reduced_data %>%
#   ggplot(aes(x = nation_race, fill = factor(pres16, levels = c("Clinton", "Trump", "Other", "Did not vote")))) +
#   geom_bar() +
#   scale_fill_manual("Candidate", values = c("Clinton" = "#01378C", "Trump" = "#ff3d3d", "Other" = "#2cd18c", "Did not vote" = "#dede1b")) +
#   labs(fil = "Candidate")


# reduced_data %>%
#   ggplot(aes(x = nation_welfare, fill = factor(pres16, levels = c("Clinton", "Trump", "Other", "Did not vote")))) +
#   geom_bar() +
#   scale_fill_manual("Candidate", values = c("Clinton" = "#01378C", "Trump" = "#ff3d3d", "Other" = "#2cd18c", "Did not vote" = "#dede1b")) +
#   labs(fil = "Candidate")

# reduced_data %>%
#   ggplot(aes(x = social_security, fill = factor(pres16, levels = c("Clinton", "Trump", "Other", "Did not vote")))) +
#   geom_bar() +
#   scale_fill_manual("Candidate", values = c("Clinton" = "#01378C", "Trump" = "#ff3d3d", "Other" = "#2cd18c", "Did not vote" = "#dede1b")) +
#   labs(fil = "Candidate")

# reduced_data %>%
#   ggplot(aes(x = race, fill = factor(pres16, levels = c("Clinton", "Trump", "Other", "Did not vote")))) +
#   geom_bar() +
#   scale_fill_manual("Candidate", values = c("Clinton" = "#01378C", "Trump" = "#ff3d3d", "Other" = "#2cd18c", "Did not vote" = "#dede1b")) +
#   labs(fil = "Candidate")

```

# Results
Summary statistics, tables, graphs, images .... 
Regression tables must not contain stars?? 

Thesis: what triggered U.S citizens to vote Clinton and Trump. 

1. nation_race 
-> This session clearly shows the difference in approval rating between Hillary Clinton and 
Donald Trump. Majority of people who thinks that national spending on improving conditions on
race has to be increased advocated Hillary Clinton. On the other hand, people who did not agree 
with them advocated Donald Trump. I assume that this is due to the image of Donald Trump. 

2. nation_arms
-> Interestingly this session shows opposite trend compared to nation_race. Aside from people who
answered "About right" and "NA", the two bars, "Too little" and "Too much" shows us opposite trend.

In general, similar to the indicators above, Hillary Clinton supporters were moved by improvement in social equality or welfare such as 
"Assistance to the Poor", "nation welfare", "nation education" and "Assistance to the other countries". On the other hand, Donald Trump supporters were interested by more conservative ideas that US is spending too much on the sessions above.


# Discussion

what is done in this paper?
what is something that we learn about the world
what is another thing that we learn about the world
what are some weaknesses of what was done?
what is left to learn or how should we proceed in the future?

## First discussion point

If my paper were 10 pages, then should be be at least 2.5 pages. The discussion is a chance to show off what you know and what you learnt from all this. 

## Second discussion point

## Third discussion point

## Weaknesses and next steps

Weaknesses and next steps should also be included.

\newpage

\appendix

# Appendix {-}


# Supplementary survey

Our supplementary survey is available here: LINK

## Preamble:

The purpose of this survey is ~~

By proceeding with this survey, you understand that we will user your responses to 
better understand () in the GSS. The survey is voluntary, and if you decide to 
participate you can skip questions and withdraw at any time.

## Questions
1. 
2. 
3. 

## End Page

Thank you ~~

\newpage


# References

